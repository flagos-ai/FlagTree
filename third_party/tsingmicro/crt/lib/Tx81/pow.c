#include "stdlib.h"
#include "math.h"
#include <stdbool.h>
#include "tx81.h"
// #include <rtthread.h>

typedef union
{
    long i;
    unsigned long u;
    double f;
    struct
    {
        unsigned int lsw;
        unsigned int msw;
    } u32s;
    struct
    {
        unsigned int manl : 32;
        unsigned int manh : 20;
        unsigned int exp : 11;
        unsigned int sign : 1;
    } bits;
}Perf_64suf;

typedef union 
{
    int i;
    unsigned int u;
    float f;
    struct
    {
        unsigned int man : 23;
        unsigned int exp : 8;
        unsigned int sign : 1;
    } bits;
}Perf_32suf;

static unsigned long __L_tbl[] = {
0x3ff0000000000000, 0x0000000000000000,
0x0000000000000000, 0x8000000000000000,
0x3fefc00000000000, 0x0000000000000000,
0x3f872c7ba2100000, 0xbd319b14945cf6ba,
0x3fef800000000000, 0x0000000000000000,
0x3f9743ee86200000, 0xbd495539356f93dc,
0x3fef400000000000, 0x0000000000000000,
0x3fa184b8e4c60000, 0xbd52a0fadb83e4fe,
0x3fef000000000000, 0x0000000000000000,
0x3fa77394c9da0000, 0xbd54e55443478fe0,
0x3feec00000000000, 0x0000000000000000,
0x3fad6ebd1f200000, 0xbd2401fbaaa67e3c,
0x3feea00000000000, 0x0000000000000000,
0x3fb0387efbcb0000, 0xbd5e5897de9078d1,
0x3fee600000000000, 0x0000000000000000,
0x3fb33f7cde150000, 0xbd48530f101bad19,
0x3fee200000000000, 0x0000000000000000,
0x3fb64ce26c060000, 0x3d5c55ad0f90a497,
0x3fede00000000000, 0x0000000000000000,
0x3fb960caf9ac0000, 0xbd520d8486e9222a,
0x3feda00000000000, 0x0000000000000000,
0x3fbc7b528b710000, 0xbd2c760bc9b188c4,
0x3fed800000000000, 0x0000000000000000,
0x3fbe0b1ae8f30000, 0xbd054cda62d3926e,
0x3fed400000000000, 0x0000000000000000,
0x3fc097e38ce60000, 0x3d2924ae921f7eca,
0x3fed000000000000, 0x0000000000000000,
0x3fc22dadc2ab0000, 0x3d5a4b69691d7994,
0x3fece00000000000, 0x0000000000000000,
0x3fc2f9e32d5c0000, 0xbd117b2f1731efbe,
0x3feca00000000000, 0x0000000000000000,
0x3fc494f863b90000, 0xbd5065a2ac5ac35f,
0x3fec800000000000, 0x0000000000000000,
0x3fc563dc29ff8000, 0x3d56590643906f2a,
0x3fec400000000000, 0x0000000000000000,
0x3fc7046031c78000, 0x3d4f84be19cb9578,
0x3fec000000000000, 0x0000000000000000,
0x3fc8a8980abf8000, 0x3d5e9933354dbf17,
0x3febe00000000000, 0x0000000000000000,
0x3fc97c1cb13c8000, 0xbd03f7a55cd2af4c,
0x3feba00000000000, 0x0000000000000000,
0x3fcb2602497d8000, 0xbd565d3990cb67ba,
0x3feb800000000000, 0x0000000000000000,
0x3fcbfc67a8000000, 0xbd3667f21fa8423f,
0x3feb400000000000, 0x0000000000000000,
0x3fcdac22d3e48000, 0xbd5f1680dd458fb2,
0x3feb200000000000, 0x0000000000000000,
0x3fce857d3d360000, 0x3d4367bde40c5e6d,
0x3feb000000000000, 0x0000000000000000,
0x3fcf5fd8a9060000, 0x3d5f1a4847f7b278,
0x3feac00000000000, 0x0000000000000000,
0x3fd08bce0d960000, 0xbd37204f55bbf90d,
0x3feaa00000000000, 0x0000000000000000,
0x3fd0fa848044c000, 0xbd495def21f8497b,
0x3fea600000000000, 0x0000000000000000,
0x3fd1d982c9d54000, 0xbd58f7ca2cff7b90,
0x3fea400000000000, 0x0000000000000000,
0x3fd249cd2b13c000, 0x3d4ad89a083e072a,
0x3fea200000000000, 0x0000000000000000,
0x3fd2baa0c34c0000, 0xbd5e1410132ae5e4,
0x3fe9e00000000000, 0x0000000000000000,
0x3fd39de8e1558000, 0x3d5f6f7f2b4bd1c4,
0x3fe9c00000000000, 0x0000000000000000,
0x3fd4106017c40000, 0xbd535d71963580ba,
0x3fe9a00000000000, 0x0000000000000000,
0x3fd48365e695c000, 0x3d5796aa2981fdbc,
0x3fe9800000000000, 0x0000000000000000,
0x3fd4f6fbb2cec000, 0x3d3661e393a16b95,
0x3fe9400000000000, 0x0000000000000000,
0x3fd5dfdcf1eec000, 0xbd51f1bbd2926f16,
0x3fe9200000000000, 0x0000000000000000,
0x3fd6552b49988000, 0xbd5d8894dbdff331,
0x3fe9000000000000, 0x0000000000000000,
0x3fd6cb0f6865c000, 0x3d41d406db502403,
0x3fe8e00000000000, 0x0000000000000000,
0x3fd7418acebc0000, 0xbd4ce2935fff809a,
0x3fe8a00000000000, 0x0000000000000000,
0x3fd8304d90c10000, 0x3d5fd32a3ab0a4b5,
0x3fe8800000000000, 0x0000000000000000,
0x3fd8a8980abfc000, 0xbd266cccab240e90,
0x3fe8600000000000, 0x0000000000000000,
0x3fd921800924c000, 0x3d5d3b7f711abd5c,
0x3fe8400000000000, 0x0000000000000000,
0x3fd99b072a96c000, 0x3d3ac9bca36fd02e,
0x3fe8200000000000, 0x0000000000000000,
0x3fda152f14298000, 0x3d1b3d7b0e65d2ce,
0x3fe8000000000000, 0x0000000000000000,
0x3fda8ff971810000, 0x3d44bc302ffa76fb,
0x3fe7e00000000000, 0x0000000000000000,
0x3fdb0b67f4f48000, 0xbd57f00af09dc1c7,
0x3fe7a00000000000, 0x0000000000000000,
0x3fdc043859e30000, 0xbd22642415d47384,
0x3fe7800000000000, 0x0000000000000000,
0x3fdc819dc2d44000, 0x3d5fe43895d8ac46,
0x3fe7600000000000, 0x0000000000000000,
0x3fdcffae611ac000, 0x3d512b628e2d05d7,
0x3fe7400000000000, 0x0000000000000000,
0x3fdd7e6c0abc4000, 0xbd450e785694a8c6,
0x3fe7200000000000, 0x0000000000000000,
0x3fddfdd89d588000, 0xbd51d4f639bb5cdf,
0x3fe7000000000000, 0x0000000000000000,
0x3fde7df5fe538000, 0x3d45669df6a2b592,
0x3fe6e00000000000, 0x0000000000000000,
0x3fdefec61b010000, 0x3d5f855b4987c5d5,
0x3fe6c00000000000, 0x0000000000000000,
0x3fdf804ae8d0c000, 0x3d4a0331af2e6fea,
0x3fe6a00000000000, 0x0000000000000000,
0x3fe0014332be0000, 0x3cf9518ce032f41d,
0x3fe6800000000000, 0x0000000000000000,
0x3fe042bd4b9a8000, 0xbd3b3b3864c60011,
0x3fe6600000000000, 0x0000000000000000,
0x3fe08494c66b8000, 0x3d5ddf82e1fe57c7,
0x3fe6400000000000, 0x0000000000000000,
0x3fe0c6caaf0c6000, 0xbd54d20c519e12f4,
0x3fe6200000000000, 0x0000000000000000,
0x3fe1096015dee000, 0x3d43676289cd3dd4,
0x3fe6000000000000, 0x0000000000000000,
0x3fe14c560fe68000, 0x3d55f101c141e670,
0x3fe5e00000000000, 0x0000000000000000,
0x3fe18fadb6e2e000, 0xbd587cc95d0a2ee8,
0x3fe5c00000000000, 0x0000000000000000,
0x3fe1d368296b6000, 0xbd5b567e7ee54aef,
0x3fe5a00000000000, 0x0000000000000000,
0x3fe217868b0c4000, 0xbd5030ab442ce320,
0x3fe5800000000000, 0x0000000000000000,
0x3fe25c0a0463c000, 0xbd250520a377c7ec,
0x3fe5800000000000, 0x0000000000000000,
0x3fe25c0a0463c000, 0xbd250520a377c7ec,
0x3fe5600000000000, 0x0000000000000000,
0x3fe2a0f3c3408000, 0xbd5f48e1a4725559,
0x3fe5400000000000, 0x0000000000000000,
0x3fe2e644fac04000, 0x3d5faf6283bf2868,
0x3fe5200000000000, 0x0000000000000000,
0x3fe32bfee370e000, 0x3d5cd0cb4492f1bc,
0x3fe5000000000000, 0x0000000000000000,
0x3fe37222bb708000, 0xbd5708b4b2b5056c,
0x3fe4e00000000000, 0x0000000000000000,
0x3fe3b8b1c68fa000, 0x3d4bb4b69336b66e,
0x3fe4c00000000000, 0x0000000000000000,
0x3fe3ffad4e750000, 0xbd5c5432aeb609f5,
0x3fe4a00000000000, 0x0000000000000000,
0x3fe44716a2c08000, 0x3d33106e404cabb7,
0x3fe4a00000000000, 0x0000000000000000,
0x3fe44716a2c08000, 0x3d33106e404cabb7,
0x3fe4800000000000, 0x0000000000000000,
0x3fe48eef19318000, 0xbd49bcaf1aa4168a,
0x3fe4600000000000, 0x0000000000000000,
0x3fe4d7380dcc4000, 0x3d31646b761c48de,
0x3fe4400000000000, 0x0000000000000000,
0x3fe51ff2e3022000, 0xbd56879fa00b120a,
0x3fe4200000000000, 0x0000000000000000,
0x3fe5692101d9c000, 0xbd56b37dcf60e620,
0x3fe4200000000000, 0x0000000000000000,
0x3fe5692101d9c000, 0xbd56b37dcf60e620,
0x3fe4000000000000, 0x0000000000000000,
0x3fe5b2c3da198000, 0xbd5b8afe492bf6ff,
0x3fe3e00000000000, 0x0000000000000000,
0x3fe5fcdce2728000, 0xbd3125d6cbcd1095,
0x3fe3c00000000000, 0x0000000000000000,
0x3fe6476d98ada000, 0xbd4bd9b32266d92c,
0x3fe3c00000000000, 0x0000000000000000,
0x3fe6476d98ada000, 0xbd4bd9b32266d92c,
0x3fe3a00000000000, 0x0000000000000000,
0x3fe6927781d94000, 0xbd5aaf6f137a3d8c,
0x3fe3800000000000, 0x0000000000000000,
0x3fe6ddfc2a790000, 0xbd3ce60916e52e91,
0x3fe3600000000000, 0x0000000000000000,
0x3fe729fd26b70000, 0x3d4f1f5ae718f241,
0x3fe3600000000000, 0x0000000000000000,
0x3fe729fd26b70000, 0x3d4f1f5ae718f241,
0x3fe3400000000000, 0x0000000000000000,
0x3fe7767c12968000, 0xbd46eb9612e0b4f3,
0x3fe3200000000000, 0x0000000000000000,
0x3fe7c37a9227e000, 0x3d4fed21f9cb2cc5,
0x3fe3000000000000, 0x0000000000000000,
0x3fe810fa51bf6000, 0x3d47f5dc57266758,
0x3fe3000000000000, 0x0000000000000000,
0x3fe810fa51bf6000, 0x3d47f5dc57266758,
0x3fe2e00000000000, 0x0000000000000000,
0x3fe85efd062c6000, 0x3d45b338360c2ae2,
0x3fe2c00000000000, 0x0000000000000000,
0x3fe8ad846cf36000, 0x3d53481b85a54d7f,
0x3fe2c00000000000, 0x0000000000000000,
0x3fe8ad846cf36000, 0x3d53481b85a54d7f,
0x3fe2a00000000000, 0x0000000000000000,
0x3fe8fc924c89a000, 0x3d5908df8ec933b3,
0x3fe2800000000000, 0x0000000000000000,
0x3fe94c287492c000, 0x3d436c101ee13440,
0x3fe2800000000000, 0x0000000000000000,
0x3fe94c287492c000, 0x3d436c101ee13440,
0x3fe2600000000000, 0x0000000000000000,
0x3fe99c48be206000, 0x3d3e41fa0a62e6ae,
0x3fe2400000000000, 0x0000000000000000,
0x3fe9ecf50bf44000, 0xbd1d97ee9124773b,
0x3fe2400000000000, 0x0000000000000000,
0x3fe9ecf50bf44000, 0xbd1d97ee9124773b,
0x3fe2200000000000, 0x0000000000000000,
0x3fea3e2f4ac44000, 0xbd13f94e00e7d6bc,
0x3fe2000000000000, 0x0000000000000000,
0x3fea8ff971810000, 0x3d54bc302ffa76fb,
0x3fe2000000000000, 0x0000000000000000,
0x3fea8ff971810000, 0x3d54bc302ffa76fb,
0x3fe1e00000000000, 0x0000000000000000,
0x3feae255819f0000, 0x3d31659d8e2d7d38,
0x3fe1c00000000000, 0x0000000000000000,
0x3feb35458761e000, 0xbd570d0fa8f9603b,
0x3fe1c00000000000, 0x0000000000000000,
0x3feb35458761e000, 0xbd570d0fa8f9603b,
0x3fe1a00000000000, 0x0000000000000000,
0x3feb88cb9a2ac000, 0xbd55bdaf522a183c,
0x3fe1a00000000000, 0x0000000000000000,
0x3feb88cb9a2ac000, 0xbd55bdaf522a183c,
0x3fe1800000000000, 0x0000000000000000,
0x3febdce9dcc96000, 0x3d2871a7610e40bd,
0x3fe1600000000000, 0x0000000000000000,
0x3fec31a27dd00000, 0x3d569378d0928989,
0x3fe1600000000000, 0x0000000000000000,
0x3fec31a27dd00000, 0x3d569378d0928989,
0x3fe1400000000000, 0x0000000000000000,
0x3fec86f7b7ea4000, 0x3d551167134e9647,
0x3fe1400000000000, 0x0000000000000000,
0x3fec86f7b7ea4000, 0x3d551167134e9647,
0x3fe1200000000000, 0x0000000000000000,
0x3fecdcebd2374000, 0xbd49ad57391924a7,
0x3fe1200000000000, 0x0000000000000000,
0x3fecdcebd2374000, 0xbd49ad57391924a7,
0x3fe1000000000000, 0x0000000000000000,
0x3fed338120a6e000, 0xbd33167ccc538261,
0x3fe0e00000000000, 0x0000000000000000,
0x3fed8aba045b0000, 0x3d2c7a4ff65ddbc9,
0x3fe0e00000000000, 0x0000000000000000,
0x3fed8aba045b0000, 0x3d2c7a4ff65ddbc9,
0x3fe0c00000000000, 0x0000000000000000,
0x3fede298ec0ba000, 0x3d5819530c22d152,
0x3fe0c00000000000, 0x0000000000000000,
0x3fede298ec0ba000, 0x3d5819530c22d152,
0x3fe0a00000000000, 0x0000000000000000,
0x3fee3b20546f6000, 0xbd556bde9f1f0d3d,
0x3fe0a00000000000, 0x0000000000000000,
0x3fee3b20546f6000, 0xbd556bde9f1f0d3d,
0x3fe0800000000000, 0x0000000000000000,
0x3fee9452c8a72000, 0xbd5fb0e626c0de13,
0x3fe0800000000000, 0x0000000000000000,
0x3fee9452c8a72000, 0xbd5fb0e626c0de13,
0x3fe0600000000000, 0x0000000000000000,
0x3feeee32e2aec000, 0x3d597da24fd75f61,
0x3fe0600000000000, 0x0000000000000000,
0x3feeee32e2aec000, 0x3d597da24fd75f61,
0x3fe0400000000000, 0x0000000000000000,
0x3fef48c34bd1e000, 0x3d52dd67591d81df,
0x3fe0400000000000, 0x0000000000000000,
0x3fef48c34bd1e000, 0x3d52dd67591d81df,
0x3fe0200000000000, 0x0000000000000000,
0x3fefa406bd244000, 0x3d3ef5d00e390a00,
0x3fe0000000000000, 0x0000000000000000,
0x3ff0000000000000, 0x0000000000000000,
0x3fe0000000000000, 0x0000000000000000,
0x3ff0000000000000, 0x0000000000000000,
};


static unsigned long __Exp_tbl[256] = {
0x0000000000000000, 0x0000000000000000, 
0x0000163da9fb3335, 0x3c9b3b4f1a88bf6e,
0x00002c9a3e778061, 0xbc7160139cd8dc5c,
0x00004315e86e7f85, 0xbc905e7a108766d1,
0x000059b0d3158574, 0x3c8cd2523567f613,
0x0000706b29ddf6de, 0xbc8bce8023f98efa,
0x0000874518759bc8, 0x3c60f74e61e6c861,
0x00009e3ecac6f383, 0x3c90a3e45b33d399,
0x0000b5586cf9890f, 0x3c979aa65d837b6d,
0x0000cc922b7247f7, 0x3c8eb51a92fdeffc,
0x0000e3ec32d3d1a2, 0x3c3ebe3d702f9cd1,
0x0000fb66affed31b, 0xbc6a033489906e0b,
0x00011301d0125b51, 0xbc9556522a2fbd0e,
0x00012abdc06c31cc, 0xbc5080ef8c4eea55,
0x0001429aaea92de0, 0xbc91c923b9d5f416,
0x00015a98c8a58e51, 0x3c80d3e3e95c55af,
0x000172b83c7d517b, 0xbc801b15eaa59348,
0x00018af9388c8dea, 0xbc8f1ff055de323d,
0x0001a35beb6fcb75, 0x3c8b898c3f1353bf,
0x0001bbe084045cd4, 0xbc96d99c7611eb26,
0x0001d4873168b9aa, 0x3c9aecf73e3a2f60,
0x0001ed5022fcd91d, 0xbc8fe782cb86389d,
0x0002063b88628cd6, 0x3c8a6f4144a6c38d,
0x00021f49917ddc96, 0x3c807a05b0e4047d,
0x0002387a6e756238, 0x3c968efde3a8a894,
0x000251ce4fb2a63f, 0x3c875e18f274487d,
0x00026b4565e27cdd, 0x3c80472b981fe7f2,
0x000284dfe1f56381, 0xbc96b87b3f71085e,
0x00029e9df51fdee1, 0x3c82f7e16d09ab31,
0x0002b87fd0dad990, 0xbc3d219b1a6fbffa,
0x0002d285a6e4030b, 0x3c8b3782720c0ab4,
0x0002ecafa93e2f56, 0x3c6e149289cecb8f,
0x000306fe0a31b715, 0x3c834d754db0abb6,
0x00032170fc4cd831, 0x3c864201e2ac744c,
0x00033c08b26416ff, 0x3c8fdd395dd3f84a,
0x000356c55f929ff1, 0xbc86a3803b8e5b04,
0x000371a7373aa9cb, 0xbc924aedcc4b5068,
0x00038cae6d05d866, 0xbc9907f81b512d8e,
0x0003a7db34e59ff7, 0xbc71d1e83e9436d2,
0x0003c32dc313a8e5, 0xbc991919b3ce1b15,
0x0003dea64c123422, 0x3c859f48a72a4c6d,
0x0003fa4504ac801c, 0xbc9312607a28698a,
0x0004160a21f72e2a, 0xbc58a78f4817895b,
0x000431f5d950a897, 0xbc7c2c9b67499a1b,
0x00044e086061892d, 0x3c4363ed60c2ac12,
0x00046a41ed1d0057, 0x3c9666093b0664ef,
0x000486a2b5c13cd0, 0x3c6ecce1daa10379,
0x0004a32af0d7d3de, 0x3c93ff8e3f0f1230,
0x0004bfdad5362a27, 0x3c7690cebb7aafb0,
0x0004dcb299fddd0d, 0x3c931dbdeb54e077,
0x0004f9b2769d2ca7, 0xbc8f94340071a38e,
0x000516daa2cf6642, 0xbc87deccdc93a349,
0x0005342b569d4f82, 0xbc78dec6bd0f385f,
0x000551a4ca5d920f, 0xbc861246ec7b5cf6,
0x00056f4736b527da, 0x3c93350518fdd78e,
0x00058d12d497c7fd, 0x3c7b98b72f8a9b05,
0x0005ab07dd485429, 0x3c9063e1e21c5409,
0x0005c9268a5946b7, 0x3c34c7855019c6ea,
0x0005e76f15ad2148, 0x3c9432e62b64c035,
0x000605e1b976dc09, 0xbc8ce44a6199769f,
0x0006247eb03a5585, 0xbc8c33c53bef4da8,
0x0006434634ccc320, 0xbc845378892be9ae,
0x0006623882552225, 0xbc93cedd78565858,
0x00068155d44ca973, 0x3c5710aa807e1964,
0x0006a09e667f3bcd, 0xbc93b3efbf5e2228,
0x0006c012750bdabf, 0xbc6a12ad8734b982,
0x0006dfb23c651a2f, 0xbc6367efb86da9ee,
0x0006ff7df9519484, 0xbc80dc3d54e08851,
0x00071f75e8ec5f74, 0xbc781f647e5a3ecf,
0x00073f9a48a58174, 0xbc86ee4ac08b7db0,
0x00075feb564267c9, 0xbc8619321e55e68a,
0x000780694fde5d3f, 0x3c909ccb5e09d4d3,
0x0007a11473eb0187, 0xbc7b32dcb94da51d,
0x0007c1ed0130c132, 0x3c94ecfd5467c06b,
0x0007e2f336cf4e62, 0x3c65ebe1abd66c55,
0x00080427543e1a12, 0xbc88a1c52fb3cf42,
0x00082589994cce13, 0xbc9369b6f13b3734,
0x0008471a4623c7ad, 0xbc805e843a19ff1e,
0x000868d99b4492ed, 0xbc94d450d872576e,
0x00088ac7d98a6699, 0x3c90ad675b0e8a00,
0x0008ace5422aa0db, 0x3c8db72fc1f0eab4,
0x0008cf3216b5448c, 0xbc65b6609cc5e7ff,
0x0008f1ae99157736, 0x3c7bf68359f35f44,
0x0009145b0b91ffc6, 0xbc93091fa71e3d83,
0x00093737b0cdc5e5, 0xbc5da9b88b6c1e29,
0x00095a44cbc8520f, 0xbc6c23f97c90b959,
0x00097d829fde4e50, 0xbc92434322f4f9aa,
0x0009a0f170ca07ba, 0xbc85ca6cd7668e4b,
0x0009c49182a3f090, 0x3c71affc2b91ce27,
0x0009e86319e32323, 0x3c6dd235e10a73bb,
0x000a0c667b5de565, 0xbc87c50422622263,
0x000a309bec4a2d33, 0x3c8b1c86e3e231d5,
0x000a5503b23e255d, 0xbc91bbd1d3bcbb15,
0x000a799e1330b358, 0x3c90cc319cee31d2,
0x000a9e6b5579fdbf, 0x3c8469846e735ab3,
0x000ac36bbfd3f37a, 0xbc82dfcd978e9db4,
0x000ae89f995ad3ad, 0x3c8c1a7792cb3387,
0x000b0e07298db666, 0xbc907b8f4ad1d9fa,
0x000b33a2b84f15fb, 0xbc55c3d956dcaeba,
0x000b59728de5593a, 0xbc90a40e3da6f640,
0x000b7f76f2fb5e47, 0xbc68d6f438ad9334,
0x000ba5b030a1064a, 0xbc91eee26b588a35,
0x000bcc1e904bc1d2, 0x3c74ffd70a5fddcd,
0x000bf2c25bd71e09, 0xbc91bdfbfa9298ac,
0x000c199bdd85529c, 0x3c736eae30af0cb3,
0x000c40ab5fffd07a, 0x3c8ee3325c9ffd94,
0x000c67f12e57d14b, 0x3c84e08fd10959ac,
0x000c8f6d9406e7b5, 0x3c63cdaf384e1a67,
0x000cb720dcef9069, 0x3c676b2c6c921968,
0x000cdf0b555dc3fa, 0xbc808a1883ccb5d2,
0x000d072d4a07897c, 0xbc8fad5d3ffffa6f,
0x000d2f87080d89f2, 0xbc900dae3875a949,
0x000d5818dcfba487, 0x3c74a385a63d07a7,
0x000d80e316c98398, 0xbc82919e2040220f,
0x000da9e603db3285, 0x3c8e5a50d5c192ac,
0x000dd321f301b460, 0x3c843a59ac016b4b,
0x000dfc97337b9b5f, 0xbc82d52107b43e1f,
0x000e264614f5a129, 0xbc892ab93b470dc9,
0x000e502ee78b3ff6, 0x3c74b604603a88d3,
0x000e7a51fbc74c83, 0x3c83c5ec519d7271,
0x000ea4afa2a490da, 0xbc8ff7128fd391f0,
0x000ecf482d8e67f1, 0xbc8dae98e223747d,
0x000efa1bee615a27, 0x3c8ec3bc41aa2008,
0x000f252b376bba97, 0x3c842b94c3a9eb32,
0x000f50765b6e4540, 0x3c8a64a931d185ee,
0x000f7bfdad9cbe14, 0xbc8e37bae43be3ed,
0x000fa7c1819e90d8, 0x3c77893b4d91cd9d,
0x000fd3c22b8f71f1, 0x3c5305c14160cc89, 
};

#define ADD_BIT 0xc010100000000000 
#define EXPMASK 0xfff0000000000000
#define EXP_SHIFTER 52776558134271.0 // 1.5000000000290754*2^45
#define ONE 1.0
#define c1l_c1h_8 2.035527417494173e-17
#define A0_ha 0.16032146466245167 
#define A1_ha 0.2885390081778253
#define A2_ha 0.20609929024234264 
#define A3_ha 0.4808983469629878
#define B0_ha -0.18035669405180624 
#define B1_ha -0.3606737602222562
#define B2_ha -0.2404491725744602 
#define B3_ha -0.7213475204444817
#define Invln2_pow 1.4426950408889634
#define C0_ha 0.0013333562801027398 
#define C1_ha 0.055504108664817364
#define D0_ha 0.009618132633217303 
#define D1_ha 0.24022650695908054
#define LN2_pow 0.6931471805599453

#define mant_mask_powf_ha (0x007fffff)
#define scaled_expon_powf_ha 0x3b800000
#define shift_powf_ha 0x00008000   //int
#define mask_powf_ha 0xffff0000   //int
#define one_powf_ha 1.0  //single-precision
#define AddConst_powf_ha 211106232532992
#define A0_powf_ha -0.3606803440419083
#define A1_powf_ha 0.48090361399617193
#define A2_powf_ha -0.72134752040442129
#define A3_powf_ha 1.4426950408769454
#define B0_powf_ha 0.055504596955955943
#define B1_powf_ha 0.24022885514364503
#define B2_powf_ha 0.69314718052020807

int32_t round_to_even2(float value) {
    // 检查是否为正向无穷大
    if (value == INFINITY) {
        return INT32_MAX;
    }
    // 检查是否为负无穷
    if (value == -INFINITY){
        return INT32_MIN;
    }
    // 获取整数部分
    float int_part = floor(fabs(value)); // 使用 fabs 来处理负数
    // 获取小数部分
    float frac_part = fabs(value) - int_part;

    if (frac_part < 0.5) {
        // 如果小数部分小于 0.5，直接舍去
        return (int32_t)(int_part) * (value < 0 ? -1 : 1);
    } else if (frac_part > 0.5) {
        // 如果小数部分大于 0.5，直接进位
        return (int32_t)(int_part + 1) * (value < 0 ? -1 : 1);
    } else {
        // 如果小数部分恰好是 0.5，根据整数部分的奇偶性决定
        int32_t int_value = (int32_t)int_part; // 整数部分的整型值
        // printf("int_value = %d\n", int_value);
        if (int_value % 2 == 0) {
            // 如果整数部分是偶数， 舍去
            return (int32_t)(int_part) * (value < 0 ? -1 : 1);
        } else {
            // 如果整数部分是奇数， 进位
            return (int32_t)(int_part + 1) * (value < 0 ? -1 : 1);
        }
    }
}

float powf(float src1, float src2)
{
    float nan = NAN;
    if (src2==0) return 1;
    if (src1==1) return 1;
    if (src2==1) return src1;
    if (isnan(src1) | isnan(src2)) return nan;
    float y = (float)src2;
    float round_y = round_to_even2(y);
    float diff = y - round_y;
    bool not_int = fabs(diff) >= 1e-9;
    if (src1==0) {
        if (src2 < 0) return INFINITY;
        return 0;
    }
    if (src1<0) {
        if (not_int) return nan;
    }
    if (fabs(src1)<0.1) {
        if (src2 > 38) return 0;
        if (src2 < -38) return INFINITY;
    }
    double n, r, r2, p, q, xd0, xd1, x0, x1, tmpf2, tmpf0, tmpf1;
    Perf_64suf z, tmp, tbl, tbl0;
    Perf_32suf m;
    unsigned long idx, xu;

    tmp.f = src1;
    xu = tmp.u + ADD_BIT;
    m.u = xu >> 32;
    m.i = m.i >> 11;
    xu = EXPMASK & xu;
    tmp.u = tmp.u - xu;
    idx = m.u;
    m.u = m.u & 0xfffffe00;
    idx = idx & 0x1fc;
    m.i = m.i >> 9;
    tbl.u = __L_tbl[idx];
    q = (double)m.i;
    r = tbl.f * tmp.f - ONE;
    tbl.u = __L_tbl[idx + 2];
    tmpf0 = q + tbl.f;
    r2 = r * r;
    tbl.u = __L_tbl[idx + 3];
    tmpf1 = r * c1l_c1h_8 + tbl.f;
    q = r * Invln2_pow + tmpf0;
    tmpf2 = tmpf0 - q;
    xd1 = r * A0_ha + B0_ha;
    xd0 = r * A3_ha + B3_ha;
    x1 = r2 * r2;
    x0 = r * A1_ha + B1_ha;
    p = r * A2_ha + B2_ha;
    r = r * Invln2_pow + tmpf2;
    xd0 = r2 * x0 + xd0;
    xd1 = r2 * xd1 + p;
    xd1 = x1 * xd1 + xd0;
    tmpf0 = r + tmpf1;
    xd1 = xd1 * r2 + tmpf0;
    
    //exp
    tmpf0 = q * src2;
    x1 = xd1 * src2 + tmpf0;
    q = src2 * q - tmpf0;
    p = tmpf0 - x1;
    z.f = EXP_SHIFTER + x1;
    p = src2 * xd1 + p;
    tmp.f = x1;
    n = z.f - EXP_SHIFTER;
    q = q + p;
    idx = tmp.u >> 32;
    idx = idx >> 16;
    idx = idx & 0x7fff;
    r = x1 - n + q;
    r2 = r * r;
    idx = z.u;
    tmp.u = idx;
    idx = idx & 0x7f;
    idx = idx + idx;
    z.f = r * C0_ha + D0_ha;
    tmp.u = tmp.u & 0xffffff80;
    q = r * C1_ha + D1_ha;
    tbl0.u = __Exp_tbl[idx];
    tbl.u = __Exp_tbl[idx + 1];
    p = LN2_pow * r + tbl.f;
    q = r2 * z.f + q;
    q = q * r2 + p;
    x0 = tmp.f;
    tmp.u = tmp.u << 45;
    tmp.u = tbl0.u | tmp.u;
    x0 = tmp.f;
    x0 = x0 * q + x0;
    if(x0 > 3.4028235e38) return INFINITY;
    return (float)x0;
}

